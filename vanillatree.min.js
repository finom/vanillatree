function extend(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}!function(e,t){"function"==typeof define&&define.amd?define(t):"object"==typeof module&&module.exports?module.exports=t():e.VanillaTree=t()}(this,function(){"use strict";var e=function(e,t){return extend(document.createElement(e),t)},t=function(t,r){var a=this,n=a.container=document.getElementsByTagName(t.tagName)[0],i=a.tree=n.appendChild(e("ul",{className:"vtree"}));a.placeholder=r&&r.placeholder,a._placeholder(),a.leafs={},i.addEventListener("click",function(e){matches(e.target,".vtree-leaf-label")?a.select(e.target.parentNode.getAttribute("data-vtree-id")):matches(e.target,".vtree-toggle")&&a.toggle(e.target.parentNode.getAttribute("data-vtree-id"))}),r&&r.contextmenu&&(i.addEventListener("contextmenu",function(t){var a,n=document.getElementsByClassName(".vtree-contextmenu");if(n.length&&n.forEach(function(e){e.parentNode.removeChild(e)}),matches(t.target,".vtree-leaf-label")){t.preventDefault(),t.stopPropagation(),a=e("menu",{className:"vtree-contextmenu"});var i=t.target.getBoundingClientRect();extend(a.style,{top:(t.target.offsetTop+i.height).toString()+"px",left:t.target.offsetLeft.toString()+"px",display:"block"}),r.contextmenu.forEach(function(r){a.appendChild(e("li",{className:"vtree-contextmenu-item",innerHTML:r.label})).addEventListener("click",r.action.bind(r,t.target.parentNode.getAttribute("data-vtree-id")))}),t.target.parentNode.appendChild(a)}}),document.addEventListener("click",function(e){if(2!==e.button){var t=document.getElementsByClassName(".vtree-contextmenu");t.length&&t.forEach(function(e){e.parentNode.removeChild(e)})}}))};return t.prototype={constructor:t,_dispatch:function(e,t){var r;try{r=new CustomEvent("vtree-"+e,{bubbles:!0,cancelable:!0,detail:{id:t}})}catch(a){(r=document.createEvent("CustomEvent")).initCustomEvent("vtree-"+e,!0,!0,{id:t})}return(this.getLeaf(t,!0)||this.tree).dispatchEvent(r),this},_placeholder:function(){var e;return!this.tree.children.length&&this.placeholder?this.tree.innerHTML='<li class="vtree-placeholder">'+this.placeholder+"</li>":(e=this.tree.querySelector(".vtree-placeholder"))&&this.tree.removeChild(e),this},getLeaf:function(e,t){var r=this.tree.querySelectorAll('[data-vtree-id="'+e+'"]')[0];if(!t&&!r)throw Error('No VanillaTree leaf with id "'+e+'"');return r},getChildList:function(t){var r,a;return t?(r=(a=this.getLeaf(t)).querySelectorAll("ul")[0])||(r=a.appendChild(e("ul",{className:"vtree-subtree"}))):r=this.tree,r},add:function(t){var r,a=e("li",{className:"vtree-leaf"}),n=this.getChildList(t.parent);return a.setAttribute("data-vtree-id",r=t.id||Math.random()),a.appendChild(e("span",{className:"vtree-toggle"})),a.appendChild(e("a",{className:"vtree-leaf-label",innerHTML:t.label})),n.appendChild(a),n!==this.tree&&n.parentNode.classList.add("vtree-has-children"),this.leafs[r]=t,t.opened||this.close(r),t.selected&&this.select(r),this._placeholder()._dispatch("add",r)},move:function(e,t){var r=this.getLeaf(e),a=r.parentNode,n=this.getLeaf(t,!0);return n&&n.classList.add("vtree-has-children"),this.getChildList(t).appendChild(r),a.parentNode.classList.toggle("vtree-has-children",!!a.children.length),this._dispatch("move",e)},remove:function(e){var t=this.getLeaf(e),r=t.parentNode;return r.removeChild(t),r.parentNode.classList.toggle("vtree-has-children",!!r.children.length),this._placeholder()._dispatch("remove",e)},open:function(e){return this.getLeaf(e).classList.remove("closed"),this._dispatch("open",e)},close:function(e){return this.getLeaf(e).classList.add("closed"),this._dispatch("close",e)},toggle:function(e){return this[this.getLeaf(e).classList.contains("closed")?"open":"close"](e)},select:function(e){var t=this.getLeaf(e);return t.classList.contains("vtree-selected")||(this.tree.querySelectorAll("li.vtree-leaf").forEach(function(e){e.classList.remove("vtree-selected")}),t.classList.add("vtree-selected"),this._dispatch("select",e)),this}},t});var matches=function(e,t){return(e.matches||e.matchesSelector||e.msMatchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.oMatchesSelector).call(e,t)};
